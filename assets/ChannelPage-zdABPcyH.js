import{u as f,j as e,L as N,h as _,i as C,y as p,a as D,r,k as v,m as L,c as B,b as F,n as $}from"./index-DtHP9t1G.js";import{V as b}from"./index-CtDILEI9.js";import{I as z}from"./index-BWybVH9w.js";const A=({video:t})=>{const s=f(),o=async()=>{if(window.confirm("Are you sure you want to delete this video?"))try{await s(_(t._id)).unwrap(),s(C(t.channel)),p.success("Video deleted successfully")}catch(a){console.error("Error deleting video:",a),p.error("Failed to delete video.")}};return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-md hover:shadow-lg transition-shadow duration-300 max-w-sm mx-auto sm:max-w-md md:max-w-lg",children:[e.jsxs(N,{to:`/video/${t._id}`,className:"block group rounded-md overflow-hidden",children:[e.jsx("div",{className:"aspect-video bg-gray-100 rounded-md overflow-hidden shadow-sm",children:e.jsx("img",{src:t.thumbnailUrl||"/default-thumbnail.jpg",alt:t.title,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105",loading:"lazy"})}),e.jsx("h3",{className:"mt-3 text-lg font-semibold text-gray-900 line-clamp-2",title:t.title,children:t.title}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 line-clamp-3",title:t.description,children:t.description||"No description available."})]}),e.jsxs("div",{className:"mt-4 flex justify-end gap-6",children:[e.jsx(N,{to:`/videos/${t._id}/edit`,className:"px-3 py-1 text-sm font-medium text-yellow-700 bg-yellow-100 rounded-md hover:bg-yellow-200 transition-colors",children:"Edit"}),e.jsx("button",{onClick:o,className:"px-3 py-1 text-sm font-medium text-red-700 bg-red-100 rounded-md hover:bg-red-200 transition-colors","aria-label":`Delete video titled ${t.title}`,children:"Delete"})]})]})},P=({channel:t,onClose:s})=>{var j;const o=f(),{loading:a,error:c}=D(n=>n.channel),[d,u]=r.useState(t.channelName),[m,h]=r.useState(t.description),[x,l]=r.useState(null),[g,E]=r.useState(((j=t.banner)==null?void 0:j.url)||""),[y,w]=r.useState(""),S=n=>{const i=n.target.files[0];l(i),E(URL.createObjectURL(i))},k=async n=>{if(n.preventDefault(),!d.trim()){w("Channel name is required.");return}const i=new FormData;i.append("channelName",d),i.append("description",m),x&&i.append("banner",x);const V=await o(v({id:t._id,updateData:i}));v.fulfilled.match(V)?(p.success("Channel updated successfully!"),s()):p.error("Failed to update channel.")};return r.useEffect(()=>{c&&w(c)},[c]),e.jsx("div",{className:"fixed inset-0 bg-gray-100 bg-opacity-40 flex items-center justify-center z-50 px-4",children:e.jsxs("div",{className:"relative bg-white p-6 rounded-xl w-full max-w-md shadow-lg border border-gray-200",children:[e.jsx("button",{className:"absolute top-3 right-3 text-gray-500 hover:text-red-500 text-2xl",onClick:s,children:e.jsx(z,{})}),e.jsx("h2",{className:"text-2xl font-semibold mb-5 text-gray-800",children:"Edit Channel"}),e.jsxs("form",{onSubmit:k,encType:"multipart/form-data",className:"space-y-4",children:[e.jsx("input",{type:"text",value:d,onChange:n=>u(n.target.value),placeholder:"Channel Name",className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("textarea",{value:m,onChange:n=>h(n.target.value),placeholder:"Description",rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded resize-none focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700",children:"Channel Banner"}),e.jsx("input",{type:"file",accept:"image/*",onChange:S,className:"text-sm"}),g&&e.jsx("img",{src:g,alt:"Preview",className:"mt-2 rounded w-full h-32 object-cover border border-gray-200"})]}),y&&e.jsx("p",{className:"text-red-600 text-sm -mt-2",children:y}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 transition",disabled:a,children:"Cancel"}),e.jsx("button",{type:"submit",className:`px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition ${a?"opacity-70 cursor-not-allowed":""}`,disabled:a,children:a?"Saving...":"Save"})]})]})]})})},R=()=>{const{id:t}=L(),s=B(),o=f(),{currentChannel:a,loading:c,error:d,videos:u}=D(l=>l.channel),[m,h]=r.useState(!1);r.useEffect(()=>{o(C(t)).unwrap().catch(l=>{b.error("Failed to load channel.")})},[o,t]);const x=async()=>{if(window.confirm("Are you sure you want to delete this channel?"))try{await o($(a._id)).unwrap(),b.success("Channel deleted successfully!"),s("/")}catch{b.error("Failed to delete channel.")}};return c?e.jsx(F,{}):d?e.jsxs("p",{className:"text-red-600 font-semibold",children:["Error: ",d]}):a?e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6",children:[a.channelBanner&&e.jsxs("div",{className:"relative h-64 w-full mb-6 rounded-xl overflow-hidden shadow-md",children:[e.jsx("img",{src:a.channelBanner,alt:"Channel Banner",className:"object-cover w-full h-full"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-80"}),e.jsxs("div",{className:"absolute bottom-4 left-4 text-white drop-shadow-lg z-10",children:[e.jsx("h2",{className:"text-3xl font-bold",children:a.channelName}),e.jsx("p",{className:"text-lg",children:a.description})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 mb-6",children:[e.jsx("button",{className:"bg-yellow-500 px-4 py-2 rounded-l-full text-white hover:bg-yellow-600 transition",onClick:()=>h(!0),children:"Edit Channel"}),e.jsx("button",{className:"bg-red-600 px-4 py-2 rounded text-white hover:bg-red-700 transition",onClick:x,children:"Delete Channel"}),e.jsx("button",{className:"bg-green-600 px-4 py-2 rounded-r-full text-white hover:bg-green-700 transition",onClick:()=>s(`/upload-video/${a._id}`),children:"Upload Video"})]}),e.jsx("h3",{className:"text-2xl font-semibold mb-4",children:"Your Videos"}),u.length===0?e.jsx("p",{className:"text-gray-500",children:"No videos yet."}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5",children:u.map(l=>e.jsx(A,{video:l},l._id))}),m&&e.jsx(P,{channel:a,onClose:()=>h(!1)})]}):e.jsx("p",{className:"text-gray-600",children:"Channel not found."})};export{R as default};
