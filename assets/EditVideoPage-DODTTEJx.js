import{r as n,j as e,y as g,m as w,u as S,c as V,a as v,q as C,b as E,s as k}from"./index-DtHP9t1G.js";import{I as y}from"./index-BWybVH9w.js";const F=["Music","Gaming","News","Sports","Education","Entertainment"],R=({video:s,onSubmit:c,videoUpdating:x})=>{const[d,b]=n.useState(""),[h,u]=n.useState(""),[a,f]=n.useState(""),[o,m]=n.useState(null),[l,p]=n.useState(null);n.useEffect(()=>{s&&(b(s.title||""),u(s.description||""),f(s.category||""))},[s]);const i=t=>{if(t.preventDefault(),!a){g.error("Please select a category");return}const r=new FormData;r.append("title",d),r.append("description",h),r.append("category",a),o&&r.append("thumbnail",o),l&&r.append("video",l),c(r)},j=()=>m(null),N=()=>p(null);return e.jsxs("form",{onSubmit:i,className:"space-y-5 max-w-md mx-auto p-4 border rounded-lg shadow",encType:"multipart/form-data",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold",children:"Title"}),e.jsx("input",{className:"w-full border px-3 py-2 rounded",value:d,onChange:t=>b(t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold",children:"Description"}),e.jsx("textarea",{className:"w-full border px-3 py-2 rounded",rows:5,value:h,onChange:t=>u(t.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-1 font-semibold",children:["Category ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{className:"w-full border px-3 py-2 rounded",value:a,onChange:t=>f(t.target.value),required:!0,children:[e.jsx("option",{value:"",children:"-- Select Category --"}),F.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold",children:"Replace Thumbnail"}),e.jsx("input",{type:"file",accept:"image/*",onChange:t=>m(t.target.files[0])}),o&&e.jsxs("div",{className:"relative w-40 mt-2",children:[e.jsx("img",{src:URL.createObjectURL(o),alt:"Preview",className:"rounded"}),e.jsx("button",{type:"button",className:"absolute top-0 right-0 text-white bg-black rounded-full px-1",onClick:j,children:e.jsx(y,{})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-semibold",children:"Replace Video"}),e.jsx("input",{type:"file",accept:"video/*",onChange:t=>p(t.target.files[0])}),l&&e.jsxs("div",{className:"relative mt-2",children:[e.jsx("video",{className:"w-full max-w-sm rounded",controls:!0,src:URL.createObjectURL(l)}),e.jsx("button",{type:"button",className:"absolute top-2 right-2 text-white bg-black rounded-full px-2",onClick:N,children:e.jsx(y,{})})]})]}),e.jsx("button",{type:"submit",disabled:x,className:"w-full bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50",children:x?"Updating...":"Update Video"})]})},U=()=>{var m,l,p;const{id:s}=w(),c=S(),x=V(),{selectedVideo:d,videoUpdating:b,videoFetching:h,error:u}=v(i=>i.videos),{user:a}=v(i=>i.auth),f=((l=(m=a==null?void 0:a.channels)==null?void 0:m[0])==null?void 0:l._id)||((p=a==null?void 0:a.channels)==null?void 0:p[0]);n.useEffect(()=>{s&&c(C(s))},[c,s]);const o=async i=>{try{await c(k({id:s,formData:i})).unwrap(),g.success("Video updated successfully!"),x(`/channel/${f}`)}catch(j){console.error("Video update error:",j),g.error("Failed to update video. Please try again.")}};return h?e.jsx(E,{}):u?e.jsxs("p",{className:"text-red-500 text-center mt-5",children:["Error: ",u]}):d?e.jsxs("div",{className:"max-w-3xl mx-auto py-10",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Edit Video"}),e.jsx(R,{video:d,onSubmit:o,videoUpdating:b})]}):e.jsx("p",{className:"text-center mt-5",children:"No video found"})};export{U as default};
